学号：PB18111793

姓名：裴启智

## 完善双人聊天室

#### 实现以换行为分隔符的消息分割

* 由于客户端发送的几条信息可能经过多次recv，故对客户端的`send`和服务端的`recv`之间不作任何的假设，只要服务端接收到数据就将其暂存，然后通过不断读取，并根据读取到的结果进行发送：
  * 如果recv到了一条或多条信息，则直接发送并清空buffer
  * 若只recv到了半条消息，则不发送，等待这条消息的换行符到达再发送
  * 若recv到了几条完整的消息但最后一条不完整，则只发送完整的消息，并将最后不完整的部分前移到buffer的最前端
  * 由于一条消息不超过1MiB，故如果出现多条消息都接近1MiB，则在recv到一条完整的消息后会发送并将这条消息在buffer中删除，并将后续收到的不完整的消息前移，并等待recv到完整的此条消息后再发送

#### 处理可能的 `send` 阻塞

* 检查每次send成功的字节数，如果和需要发送的字节数相同，则发送成功。如果该字节数小于需要发送的字节数，则继续发送剩下的部分，直到判定为全部发送为止

## 利用多线程技术实现多人聊天室

* 每个客户端都有对应的发送和接收线程，且有各自的发送队列

* 首先建立64个线程，两两一组作为某个客户端的服务端线程（一个负责接受，一个负责发送），每个客户端为一个结构体，在接受线程中进行某个客户端的连接以及写入其他客户端的发送队列，在写入完成后唤醒发送线程，将当前客户端发送队列中的数据发送给客户端

## 利用 IO 复用 / 异步 IO 技术实现多人聊天室

* 每个客户端在可读时读入数据，写入对应的发送队列，在可写时发送
* 







